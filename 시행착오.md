# 시행착오

## ROS

사용 목적: ROS를 통해 카메라를 효율적으로 사용하고, 향후 ROS기반의 로봇공학에 접근하기 위해


Jetbot의 ROS 설치는 아래의 사이트들을 참조 하였다.

출처: <https://github.com/dusty-nv/jetbot_ros>


### Jetbot motor drive

#### Problem 1 motor library
현재 jetbot 라이브러리에서 지원해주는 motor 구동은 python3에서 가능하다.

하지만 ROS python2 기반이기 때문에 이에 따른 python2와 라이브러리 재설치를 해야한다.

```
sudo apt-get install python-pip
```

위의 사이트에서는 이에 대해 설명 되었지만 현재 python3로 defalut되어 있어

다른 블로그를 참고하여 python2에 설치하는 법을 찾았다. 

```
pip2 install Adafruit-MotorHAT
pip2 install Adafruit-SSD1306
```
출처:http://blog.naver.com/PostView.nhn?blogId=zeta0807&logNo=222084985732&parentCategoryNo=&categoryNo=&viewDate=&isShowPopularPosts=false&from=postView

이후 과정은 1번째 과정과 동일하게 진행할 수 있다.

#### Problem 2 not working motor
이전 problem1을 통해 라이브러리를 옳바르게 설치하여도 모터가 동작하지 않는 문제가 발생한다.

이는 i2c통신을 하는 모터드라이브의 확률이 있으므로 다음의 코드를 통해 i2c 연결 상태를 확인 해 본다.

```
sudo i2cdetect -y -r 0
sudo i2cdetect -y -r 1
```
하지만 이때 0x40 또는 0x41에 연결이 확인 되었으나 모터가 동작 하지 않는 경우가 있다.

이는 i2c통신을 하는 모터 드라이브와 라이브러리가 잘못 매칭되어 발생하는 문제로 추정 된다.

이러한 경우 모터 라이브러리에 접근하여 수정할 필요가 있다.

우선 1번째 설치 과정을 수행하면 jetbot_ros/scripts/jetbot_motors.py 노드를 찾을 수 있다.

여기서 18번째 줄의 motor_ID 를 3으로 그러면 ROS예제를 실행 시켰을 때 오른쪽 모터가 돌아 가는 것을 확인 할 수 있다.

이후 왼쪽 바퀴는 Adafruit_MotorHAT라이브러리 경로에 접근 하여 수정해야 한다.

```
cd ./.local/lib/python2.7/site-packages
```

로 들어가서 Adafruit-MotorHAT 라이브러리를 찾는다. (이 근처인데 정확한 경로는 기억이 나지 않습니다.)

